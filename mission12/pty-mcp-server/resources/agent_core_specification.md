# エクセルデータ仕様書

## 基本情報
- 保存先: C:\work\lambda-tuber\ai-trial\mission12\docs\みくるのエクセル.xlsx
- 使用ツール
    - python -i
    - pip
    - pywin32
    - xlwings


## シート仕様
- 1行目は使用しないでください。
- A列は使用しないでください。
- 列の幅は、最大30pxまでとしてください。
- すべてのセルの書式設定において、「折り返して全体を表示する」を有効化してください。
- 表示は、改ページプレビューを設定してください。
- 印刷の用紙設定は、A4横方向で設定してください。
- ページ設定の拡大縮小印刷は、「次のページに合わせて印刷」を指定して、横1 x 縦1を設定してください。


## テーブル仕様
- テーブルの左上に、タイトルを記載してください。
- タイトルの下に、1行の空行をおいてください。
- テーブルの先頭行は、ヘッダーです。
- ヘッダーのセルの背景色は、薄いピンクにしてください。
- ヘッダーの文字はボールドにしてください。
- ヘッダーの文字は中央揃えとしてください。
- テーブルの先頭列は、必ず「No.」カラムとしてください。
- テーブルの最後列は、必ず「注記」カラムとしてください。
- テーブルの罫線は、実線で記載してください。
- 可能な限り、折り返しが発生しないように列幅を調整してください。
- 行の高さは必要最小限の高さとしてください。


## NERV電話帳データ仕様
- シート名: NERV電話帳
- テーブル
    - NERV電話帳
        - カラム : 名前, 電話番号
        - データ数 : 3件
            - アスカ, 0120-1234-5678
            - シンジ, 080-9876-5432
            - 綾波, 090-9876-5432


## お絵かきドット仕様
- シート名: お絵かきドット
- 方眼紙
  - 列幅は、30ピクセルとしてください。
  - 行高は、30ピクセルとしてください。
    

## みくるの計算機仕様
- シート名: みくるの計算機
- 四則演算行仕様
  - 第1オペランド セル: 数値
  - 演算子 セル:「＋、ー、×、÷」のリスト選択
  - 第2オペランド セル: 数値
  - 等号 セル: =
  - 回答 セル: 第1オペランド、演算子、第2オペランドを参照した数式


## 日経平均レポート
- シート名: 日経平均レポート
- データ仕様
  - 株価データ: yfinance.Ticker("^N225")を用いて最新情報を取得する。
  - データ範囲: 株価データの範囲は、過去2週間を対象とする。
  - PNGグラフデータ: 株価データをmplfinanceでPNGに変換した画像。  
      変換例
      ```
      ticker = yf.Ticker("^N225")
      data = ticker.history(start=start_date, end=end_date)
      mpfstyle = mpf.make_mpf_style(base_mpf_style="yahoo", rc = {'font.family': 'Meiryo'})
      fig, axlist = mpf.plot(data, type='candle', style=mpfstyle, returnfig=True, figsize=(10,6))
      fig.savefig(io.BytesIO(), format="png", dpi=150, bbox_inches="tight")
      ws.pictures.add(fig, name="chart", left=100, top=100)
      ```
- ウィジェット仕様
  - 配置: グリッド
      - タイトル: 日経平均レポート
      - レポート日: YYYY/MM/DD 
      - 日経平均データ表: 日付、株価
      - グラフ: エクセルのグラフ挿入による折れ線グラフ
      - PNG画像: PNGグラフデータ
      - 今週の状況: 300文字程度。6列を結合して表示する。
      - 来週の状況: 300文字程度。6列を結合して表示する。
  - 重複: 許可しない
  - 背景色: ウィジェット単位でランダム指定
